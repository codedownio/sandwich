<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.3.2">
<title data-rh="true">Introducing Sandwich | Sandwich</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://codedownio.github.io/sandwich/blog/introducing-sandwich"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Introducing Sandwich | Sandwich"><meta data-rh="true" name="description" content="It&#x27;s been a little over a year since I made the first commit on a new test framework. At the time I was working with a large and complex test suite, starting and stopping lots of Docker containers of different kinds and running Selenium tests against them. Several pieces of this infrastructure had dependencies on other pieces, and they needed to be started up and torn down gracefully, especially when one piece had a problem. It was essential to be able to quickly diagnose why some component was freezing and hanging the tests."><meta data-rh="true" property="og:description" content="It&#x27;s been a little over a year since I made the first commit on a new test framework. At the time I was working with a large and complex test suite, starting and stopping lots of Docker containers of different kinds and running Selenium tests against them. Several pieces of this infrastructure had dependencies on other pieces, and they needed to be started up and torn down gracefully, especially when one piece had a problem. It was essential to be able to quickly diagnose why some component was freezing and hanging the tests."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2021-07-19T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/thomasjm"><link data-rh="true" rel="icon" href="/sandwich/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://codedownio.github.io/sandwich/blog/introducing-sandwich"><link data-rh="true" rel="alternate" href="https://codedownio.github.io/sandwich/blog/introducing-sandwich" hreflang="en"><link data-rh="true" rel="alternate" href="https://codedownio.github.io/sandwich/blog/introducing-sandwich" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://codedownio.github.io/sandwich/blog/introducing-sandwich","mainEntityOfPage":"https://codedownio.github.io/sandwich/blog/introducing-sandwich","url":"https://codedownio.github.io/sandwich/blog/introducing-sandwich","headline":"Introducing Sandwich","name":"Introducing Sandwich","description":"It's been a little over a year since I made the first commit on a new test framework. At the time I was working with a large and complex test suite, starting and stopping lots of Docker containers of different kinds and running Selenium tests against them. Several pieces of this infrastructure had dependencies on other pieces, and they needed to be started up and torn down gracefully, especially when one piece had a problem. It was essential to be able to quickly diagnose why some component was freezing and hanging the tests.","datePublished":"2021-07-19T00:00:00.000Z","author":{"@type":"Person","name":"Tom McLaughlin","description":"Author","url":"https://github.com/thomasjm","image":"https://avatars.githubusercontent.com/u/1634990?v=4"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://codedownio.github.io/sandwich/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/sandwich/blog/rss.xml" title="Sandwich RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/sandwich/blog/atom.xml" title="Sandwich Atom Feed"><link rel="stylesheet" href="/sandwich/assets/css/styles.67d35847.css">
<script src="/sandwich/assets/js/runtime~main.2f61380d.js" defer="defer"></script>
<script src="/sandwich/assets/js/main.476f1093.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_NiiT" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/sandwich/"><div class="navbar__logo"><img src="/sandwich/img/logo.svg" alt="Sandwich" class="themedComponent_ePPg themedComponent--light_A2Ez"><img src="/sandwich/img/logo.svg" alt="Sandwich" class="themedComponent_ePPg themedComponent--dark_Hian"></div><b class="navbar__title text--truncate">Sandwich</b></a><a class="navbar__item navbar__link" href="/sandwich/docs/">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/sandwich/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/codedownio/sandwich" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_qMpq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_SWdE colorModeToggle_ZDdf"><button class="clean-btn toggleButton_m3uC toggleButtonDisabled_sCSe" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_jmhg"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_qgNX"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_IG55"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_A4om"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_SNjY thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_DWIB margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Chgq clean-list"><li class="sidebarItem_jebu"><a class="sidebarItemLink_APmK" href="/sandwich/blog/sandwich-year-one">Sandwich&#x27;s First Birthday</a></li><li class="sidebarItem_jebu"><a aria-current="page" class="sidebarItemLink_APmK sidebarItemLinkActive_DMcN" href="/sandwich/blog/introducing-sandwich">Introducing Sandwich</a></li></ul></nav></aside><main class="col col--7"><article><header><h1 class="title_pFwp">Introducing Sandwich</h1><div class="container_yk91 margin-vert--md"><time datetime="2021-07-19T00:00:00.000Z">July 19, 2021</time> · <!-- -->3 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol__6XH"><div class="avatar margin-bottom--sm"><a href="https://github.com/thomasjm" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/1634990?v=4" alt="Tom McLaughlin"></a><div class="avatar__intro"><div class="avatar__name"><a href="https://github.com/thomasjm" target="_blank" rel="noopener noreferrer"><span>Tom McLaughlin</span></a></div><small class="avatar__subtitle">Author</small></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>It&#x27;s been a little over a year since I made the first commit on a new test framework. At the time I was working with a large and complex test suite, starting and stopping lots of Docker containers of different kinds and running Selenium tests against them. Several pieces of this infrastructure had dependencies on other pieces, and they needed to be started up and torn down gracefully, especially when one piece had a problem. It was essential to be able to quickly diagnose why some component was freezing and hanging the tests.</p>
<p>But why write a new test framework? Working with existing frameworks, I found myself wanting several things:</p>
<ul>
<li>
<p><strong>More visibility into and control over parallelism.</strong> I wanted to be able to easily see how many threads were running and what they were doing. This led to creating the terminal UI interface, and other reporting tools like the Slack integration and test timing capabilities.</p>
</li>
<li>
<p><strong>More logging and tracing capabilities.</strong> So I integrated <code>MonadLogger</code> capabilities into the test tree and created an on-disk representation where test logs and artifacts could be organized.</p>
</li>
<li>
<p><strong>Easier management of contexts.</strong> I had some <a href="https://codedownio.github.io/sandwich/docs/contexts" target="_blank" rel="noopener noreferrer">ideas</a> about how to use type-level nonsense to manage contexts in the test tree in such a way that they&#x27;re keyed by a certain label, which tests can retrieve when needed. Also, it&#x27;s a small thing, but I wanted access to a full monad transformer stack in an introduce node (Hspec hooks just use IO).</p>
</li>
<li>
<p><strong>Better UX for complex test trees.</strong> When you have a lot of test tree nodes devoted to starting and stopping dependencies, timing things, and other bookkeeping, it can be hard to see the actual tests in the output. This was solved with the creation of <a href="https://codedownio.github.io/sandwich/docs/node_options#visibility-thresholds" target="_blank" rel="noopener noreferrer">visibility thresholds</a>.</p>
</li>
<li>
<p><strong>Pervasive CallStack support.</strong> Every Sandwich formatter uses <code>HasCallStack</code> to report the exact source locations of test failures. There&#x27;s even a feature in the terminal interface where you can jump to test and failure locations in your editor with a single keystroke.</p>
</li>
<li>
<p><strong>Integrations</strong> with certain things I use heavily, namely Selenium. I had built up a fair amount of machinery for running Selenium tests, and it made sense to integrate it with the test suite.</p>
</li>
</ul>
<p>Undoubtedly I could have gotten a lot of this by continuing to work with Hspec or Tasty, which are both great tools. Was it worth it? Personally I&#x27;ve been using it happily for a while now, but you be the judge :)</p>
<hr>
<p>About the name: while designing this I was thinking about how to expose the <a href="https://hackage.haskell.org/package/base-4.15.0.0/docs/Control-Exception.html#v:bracket" target="_blank" rel="noopener noreferrer">bracket</a> pattern in a test node such as <a href="http://hackage.haskell.org/package/sandwich/docs/Test-Sandwich.html#v:introduceWith" target="_blank" rel="noopener noreferrer">introduceWith</a>. Around the same time, California opened up outdoor dining for the first time during the Covid lockdowns, and I had a really good sandwich on a beautiful day outside. Maybe because it was the first respite in a while from my own cooking, but that sandwich stuck in my mind (along with the image of &quot;sandwiching&quot; test tree nodes between setup and teardown functions).</p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/master/website/blog/blog/2021-07-19-introducing-sandwich.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_gEVS" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_X6Ll"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/sandwich/blog/sandwich-year-one"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Sandwich&#x27;s First Birthday</div></a></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/sandwich/docs/">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/sandwich/docs/formatters/slack">Slack integration</a></li><li class="footer__item"><a class="footer__link-item" href="/sandwich/docs/extensions/sandwich-webdriver">Selenium integration</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/codedownio/sandwich/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_qMpq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/sandwich/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/codedownio/sandwich" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_qMpq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Tom McLaughlin. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>