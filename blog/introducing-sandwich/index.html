<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.72">
<link rel="alternate" type="application/rss+xml" href="/sandwich/blog/rss.xml" title="Sandwich Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/sandwich/blog/atom.xml" title="Sandwich Blog Atom Feed"><title data-react-helmet="true">Introducing Sandwich | Sandwich</title><meta data-react-helmet="true" property="og:title" content="Introducing Sandwich | Sandwich"><meta data-react-helmet="true" name="description" content="It&#x27;s been a little over a year since I made the first commit on a new test framework. At the time I was working with a large and complex test suite, starting and stopping lots of Docker containers of different kinds and running Selenium tests against them. Several pieces of this infrastructure had dependencies on other pieces, and they needed to be started up and torn down gracefully, especially when one piece had a problem. It was essential to be able to quickly diagnose why some component was freezing and hanging the tests."><meta data-react-helmet="true" property="og:description" content="It&#x27;s been a little over a year since I made the first commit on a new test framework. At the time I was working with a large and complex test suite, starting and stopping lots of Docker containers of different kinds and running Selenium tests against them. Several pieces of this infrastructure had dependencies on other pieces, and they needed to be started up and torn down gracefully, especially when one piece had a problem. It was essential to be able to quickly diagnose why some component was freezing and hanging the tests."><meta data-react-helmet="true" property="og:url" content="https://github.com/codedownio/sandwich/sandwich/blog/introducing-sandwich"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><link data-react-helmet="true" rel="shortcut icon" href="/sandwich/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://github.com/codedownio/sandwich/sandwich/blog/introducing-sandwich"><link data-react-helmet="true" rel="alternate" href="https://github.com/codedownio/sandwich/sandwich/blog/introducing-sandwich" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://github.com/codedownio/sandwich/sandwich/blog/introducing-sandwich" hreflang="x-default"><link rel="stylesheet" href="/sandwich/assets/css/styles.66af1def.css">
<link rel="preload" href="/sandwich/assets/js/styles.f730fd94.js" as="script">
<link rel="preload" href="/sandwich/assets/js/runtime~main.966330a2.js" as="script">
<link rel="preload" href="/sandwich/assets/js/main.aed8eef3.js" as="script">
<link rel="preload" href="/sandwich/assets/js/1.bce80bcf.js" as="script">
<link rel="preload" href="/sandwich/assets/js/2.3ea8622d.js" as="script">
<link rel="preload" href="/sandwich/assets/js/3.a21580c9.js" as="script">
<link rel="preload" href="/sandwich/assets/js/ccc49370.eb7f478c.js" as="script">
<link rel="preload" href="/sandwich/assets/js/c626ff3a.5181ebc5.js" as="script">
<link rel="preload" href="/sandwich/assets/js/07e149e0.bf253895.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/sandwich/"><img src="/sandwich/img/logo.svg" alt="Sandwich" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/sandwich/img/logo.svg" alt="Sandwich" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Sandwich</strong></a><a class="navbar__item navbar__link" href="/sandwich/docs/">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/sandwich/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/codedownio/sandwich" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_GrZ2"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/sandwich/"><img src="/sandwich/img/logo.svg" alt="Sandwich" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/sandwich/img/logo.svg" alt="Sandwich" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Sandwich</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/sandwich/docs/">Docs</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/sandwich/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/codedownio/sandwich" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper blog-wrapper"><div class="container margin-vert--lg"><div class="row"><div class="col col--3"><div class="sidebar_2ahu thin-scrollbar"><h3 class="sidebarItemTitle_2hhb">Recent posts</h3><ul class="sidebarItemList_2xAf"><li class="sidebarItem_2UVv"><a aria-current="page" class="sidebarItemLink_1RT6 sidebarItemLinkActive_12pM" href="/sandwich/blog/introducing-sandwich">Introducing Sandwich</a></li></ul></div></div><main class="col col--7"><article><header><h1 class="margin-bottom--sm blogPostTitle_GeHD">Introducing Sandwich</h1><div class="margin-vert--md"><time datetime="2021-07-19T00:00:00.000Z" class="blogPostDate_fNvV">July 18, 2021 Â· 3 min read</time></div><div class="avatar margin-vert--md"><a href="https://github.com/thomasjm" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="https://avatars.githubusercontent.com/u/1634990?v=4" alt="Tom McLaughlin"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/thomasjm" target="_blank" rel="noopener noreferrer">Tom McLaughlin</a></h4><small class="avatar__subtitle">Author</small></div></div></header><div class="markdown"><p>It&#x27;s been a little over a year since I made the first commit on a new test framework. At the time I was working with a large and complex test suite, starting and stopping lots of Docker containers of different kinds and running Selenium tests against them. Several pieces of this infrastructure had dependencies on other pieces, and they needed to be started up and torn down gracefully, especially when one piece had a problem. It was essential to be able to quickly diagnose why some component was freezing and hanging the tests.</p><p>But why write a new test framework? Working with existing frameworks, I found myself wanting several things:</p><ul><li><p><strong>More visibility into and control over parallelism.</strong> I wanted to be able to easily see how many threads were running and what they were doing. This led to creating the terminal UI interface, and other reporting tools like the Slack integration and test timing capabilities.</p></li><li><p><strong>More logging and tracing capabilities.</strong> So I integrated <code>MonadLogger</code> capabilities into the test tree and created an on-disk representation where test logs and artifacts could be organized.</p></li><li><p><strong>Easier management of contexts.</strong> I had some <a href="https://hackage.haskell.org/package/sandwich-0.1.0.8/docs/Test-Sandwich.html#v:introduce" target="_blank" rel="noopener noreferrer">ideas</a> about how to use type-level nonsense to manage contexts in the test tree in such a way that they&#x27;re keyed by a certain label, which tests can retrieve when needed. Also, it&#x27;s a small thing, but I wanted access to a full monad transformer stack in an introduce node (Hspec hooks just use IO).</p></li><li><p><strong>Better UX for complex test trees.</strong> When you have a lot of test tree nodes devoted to starting and stopping dependencies, timing things, and other bookkeeping, it can be hard to see the actual tests in the output. This was solved with the creation of <a href="https://codedownio.github.io/sandwich/docs/node_options#visibility-thresholds" target="_blank" rel="noopener noreferrer">visibility thresholds</a>.</p></li><li><p><strong>Integrations</strong> with certain things I use heavily, namely Selenium. I had built up a fair amount of machinery for running Selenium tests, and it made sense to integrate it with the test suite.</p></li></ul><p>Undoubtedly I could have gotten a lot of this by continuing to work with Hspec and Tasty, which are both great tools. Was it worth it? Personally I&#x27;ve been using it happily for a while now, but you be the judge :)</p><hr><p>About the name: while designing this I was thinking about how to expose the <a href="https://hackage.haskell.org/package/base-4.15.0.0/docs/Control-Exception.html#v:bracket" target="_blank" rel="noopener noreferrer">bracket</a> pattern in a test node such as <a href="http://hackage.haskell.org/package/sandwich/docs/Test-Sandwich.html#v:introduceWith" target="_blank" rel="noopener noreferrer">introduceWith</a>. Around the same time, California opened up outdoor dining for the first time during the Covid lockdowns, and I had a really good sandwich on a beautiful day outside. Maybe because it was the first respite in a while from my own cooking, but that sandwich stuck in my mind.</p></div></article><div><a href="https://github.com/facebook/docusaurus/edit/master/website/blog/blog/2021-07-19-introducing-sandwich.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></main><div class="col col--2"><div class="tableOfContents_35-E thin-scrollbar"></div></div></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/sandwich/docs/">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/sandwich/docs/formatters/slack">Slack integration</a></li><li class="footer__item"><a class="footer__link-item" href="/sandwich/docs/extensions/sandwich-webdriver">Selenium integration</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/codedownio/sandwich/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Discussions</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/sandwich/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/codedownio/sandwich" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Tom McLaughlin. Built with Docusaurus.</div></div></div></footer></div>
<script src="/sandwich/assets/js/styles.f730fd94.js"></script>
<script src="/sandwich/assets/js/runtime~main.966330a2.js"></script>
<script src="/sandwich/assets/js/main.aed8eef3.js"></script>
<script src="/sandwich/assets/js/1.bce80bcf.js"></script>
<script src="/sandwich/assets/js/2.3ea8622d.js"></script>
<script src="/sandwich/assets/js/3.a21580c9.js"></script>
<script src="/sandwich/assets/js/ccc49370.eb7f478c.js"></script>
<script src="/sandwich/assets/js/c626ff3a.5181ebc5.js"></script>
<script src="/sandwich/assets/js/07e149e0.bf253895.js"></script>
</body>
</html>