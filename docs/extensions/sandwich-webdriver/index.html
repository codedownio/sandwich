<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-extensions/sandwich-webdriver" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.3.2">
<title data-rh="true">Selenium | Sandwich</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://codedownio.github.io/sandwich/docs/extensions/sandwich-webdriver"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Selenium | Sandwich"><meta data-rh="true" name="description" content="Setting up Selenium tests normally requires manual work to obtain the Selenium server JAR file and a driver program for your browser, launch the server, and connect to the server with your client library. It can be error-prone to make sure the versions are compatible and everything runs smoothly."><meta data-rh="true" property="og:description" content="Setting up Selenium tests normally requires manual work to obtain the Selenium server JAR file and a driver program for your browser, launch the server, and connect to the server with your client library. It can be error-prone to make sure the versions are compatible and everything runs smoothly."><link data-rh="true" rel="icon" href="/sandwich/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://codedownio.github.io/sandwich/docs/extensions/sandwich-webdriver"><link data-rh="true" rel="alternate" href="https://codedownio.github.io/sandwich/docs/extensions/sandwich-webdriver" hreflang="en"><link data-rh="true" rel="alternate" href="https://codedownio.github.io/sandwich/docs/extensions/sandwich-webdriver" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/sandwich/blog/rss.xml" title="Sandwich RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/sandwich/blog/atom.xml" title="Sandwich Atom Feed"><link rel="stylesheet" href="/sandwich/assets/css/styles.67d35847.css">
<script src="/sandwich/assets/js/runtime~main.2f61380d.js" defer="defer"></script>
<script src="/sandwich/assets/js/main.476f1093.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_NiiT" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/sandwich/"><div class="navbar__logo"><img src="/sandwich/img/logo.svg" alt="Sandwich" class="themedComponent_ePPg themedComponent--light_A2Ez"><img src="/sandwich/img/logo.svg" alt="Sandwich" class="themedComponent_ePPg themedComponent--dark_Hian"></div><b class="navbar__title text--truncate">Sandwich</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/sandwich/docs/">Docs</a><a class="navbar__item navbar__link" href="/sandwich/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/codedownio/sandwich" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_qMpq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_SWdE colorModeToggle_ZDdf"><button class="clean-btn toggleButton_m3uC toggleButtonDisabled_sCSe" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_jmhg"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_qgNX"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_IG55"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_A4om"><div class="docsWrapper_yYWD"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_bGBf" type="button"></button><div class="docRoot_IVVO"><aside class="theme-doc-sidebar-container docSidebarContainer_ssKN"><div class="sidebarViewport_CxJV"><div class="sidebar_uQEE"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_dLlL"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/sandwich/docs/">Basics</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/sandwich/docs/formatters/tui">Formatters</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/sandwich/docs/extensions/sandwich-golden">Extensions</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/sandwich/docs/extensions/sandwich-golden">Golden testing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/sandwich/docs/extensions/sandwich-hedgehog">Hedgehog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/sandwich/docs/extensions/sandwich-quickcheck">QuickCheck</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/sandwich/docs/extensions/sandwich-webdriver">Selenium</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/sandwich/docs/context-libraries/sandwich-contexts">Context libraries</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_tEpJ"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_J1ad"><div class="docItemContainer_Llw1"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_CjKK" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/sandwich/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_NA_A"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Extensions</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Selenium</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_Fq3_ theme-doc-toc-mobile tocMobile_a4FT"><button type="button" class="clean-btn tocCollapsibleButton_jMQr">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Selenium</h1></header><p>Setting up Selenium tests normally requires manual work to obtain the Selenium server JAR file and a driver program for your browser, launch the server, and connect to the server with your client library. It can be error-prone to make sure the versions are compatible and everything runs smoothly.</p>
<p>The <code>sandwich-webdriver</code> extension streamlines this by automatically downloading the latest compatible binary files and introducing the contexts you need to use the <a href="https://hackage.haskell.org/package/webdriver" target="_blank" rel="noopener noreferrer">webdriver</a> package within Sandwich. Here&#x27;s how easy it is to get started:</p>
<div class="language-haskell codeBlockContainer_U6bZ theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_I3XA"><pre tabindex="0" class="prism-code language-haskell codeBlock_jAeK thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_XajP"><span class="token-line" style="color:#bfc7d5"><span class="token import-statement keyword" style="font-style:italic">import</span><span class="token import-statement"> Test</span><span class="token import-statement punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token import-statement">Sandwich</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token import-statement keyword" style="font-style:italic">import</span><span class="token import-statement"> Test</span><span class="token import-statement punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token import-statement">Sandwich</span><span class="token import-statement punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token import-statement">WebDriver</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token import-statement keyword" style="font-style:italic">import</span><span class="token import-statement"> Test</span><span class="token import-statement punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token import-statement">WebDriver</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token hvariable">spec</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">TopSpec</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token hvariable">spec</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token hvariable">introduceWebDriver</span><span class="token plain"> </span><span class="token hvariable">defaultWdOptions</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">$</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token hvariable">it</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;opens Google and searches&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">$</span><span class="token plain"> </span><span class="token hvariable">withSession1</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">$</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token hvariable">openPage</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;http://www.google.com&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token hvariable">search</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;-</span><span class="token plain"> </span><span class="token hvariable">findElem</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token constant" style="color:rgb(130, 170, 255)">ByCSS</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;*[title=&#x27;Search&#x27;]&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token hvariable">click</span><span class="token plain"> </span><span class="token hvariable">search</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token hvariable">sendKeys</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;asdf\n&quot;</span><span class="token plain"> </span><span class="token hvariable">search</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token hvariable">main</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">IO</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token hvariable">main</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token hvariable">runSandwich</span><span class="token plain"> </span><span class="token hvariable">defaultOptions</span><span class="token plain"> </span><span class="token hvariable">spec</span><br></span></code></pre><div class="buttonGroup_fUqw"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_xOtH" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_SKyo"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_vKap"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To see a demo, try running <code>stack run demo-webdriver</code> in the Sandwich repo.</p>
<h2 class="anchor anchorWithStickyNavbar_ft1v" id="browser-sessions">Browser sessions<a href="#browser-sessions" class="hash-link" aria-label="Direct link to Browser sessions" title="Direct link to Browser sessions">​</a></h2>
<p>You can start a Selenium session using the <code>withSession</code> function. It accepts a string key representing the name of the session. Each time a new session name is seen, it will be created if it doesn&#x27;t already exist.</p>
<p>The library provides <code>withSession1</code>/<code>withSession2</code> as convenience functions for <code>withSession &quot;browser1&quot;</code>/<code>withSession &quot;browser2&quot;</code>, but you can use your own keys if you need.</p>
<p>For example, the code below opens two windows with a different site in each.</p>
<div class="language-haskell codeBlockContainer_U6bZ theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_I3XA"><pre tabindex="0" class="prism-code language-haskell codeBlock_jAeK thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_XajP"><span class="token-line" style="color:#bfc7d5"><span class="token hvariable">spec</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">TopSpec</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token hvariable">spec</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token hvariable">introduceWebDriver</span><span class="token plain"> </span><span class="token hvariable">defaultWdOptions</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">$</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token hvariable">describe</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;two browser sessions&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">$</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token hvariable">it</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;opens Google&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">$</span><span class="token plain"> </span><span class="token hvariable">withSession1</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">$</span><span class="token plain"> </span><span class="token hvariable">openPage</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;http://www.google.com&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token hvariable">it</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;opens Yahoo&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">$</span><span class="token plain"> </span><span class="token hvariable">withSession2</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">$</span><span class="token plain"> </span><span class="token hvariable">openPage</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;http://www.yahoo.com&quot;</span><br></span></code></pre><div class="buttonGroup_fUqw"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_xOtH" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_SKyo"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_vKap"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_ft1v" id="window-positioning">Window positioning<a href="#window-positioning" class="hash-link" aria-label="Direct link to Window positioning" title="Direct link to Window positioning">​</a></h2>
<p>You can use the functions in <a href="http://hackage.haskell.org/package/sandwich-webdriver/docs/Test-Sandwich-WebDriver-Windows.html" target="_blank" rel="noopener noreferrer">Test.Sandwich.WebDriver.Windows</a> to arrange browser windows on the screen. This is useful when you want to watch two browsers simultaneously accessing a collaborative app.</p>
<p>The code below extends the previous example with window positioning. You can find this in the <code>webdriver-positioning</code> demo.</p>
<div class="language-haskell codeBlockContainer_U6bZ theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_I3XA"><pre tabindex="0" class="prism-code language-haskell codeBlock_jAeK thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_XajP"><span class="token-line" style="color:#bfc7d5"><span class="token hvariable">positioning</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">TopSpec</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token hvariable">positioning</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token hvariable">introduceWebDriver</span><span class="token plain"> </span><span class="token hvariable">defaultWdOptions</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">$</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token hvariable">describe</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;two windows side by side&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">$</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token hvariable">it</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;opens Google&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">$</span><span class="token plain"> </span><span class="token hvariable">withSession1</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">$</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token hvariable">openPage</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;http://www.google.com&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token hvariable">setWindowLeftSide</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token hvariable">it</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;opens Yahoo&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">$</span><span class="token plain"> </span><span class="token hvariable">withSession2</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">$</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token hvariable">openPage</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;http://www.yahoo.com&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token hvariable">setWindowRightSide</span><br></span></code></pre><div class="buttonGroup_fUqw"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_xOtH" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_SKyo"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_vKap"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_ft1v" id="launching-browsers-in-the-background">Launching browsers in the background<a href="#launching-browsers-in-the-background" class="hash-link" aria-label="Direct link to Launching browsers in the background" title="Direct link to Launching browsers in the background">​</a></h2>
<p>This package makes it easy to run Selenium tests in the background, using either <a href="https://en.wikipedia.org/wiki/Xvfb" target="_blank" rel="noopener noreferrer">Xvfb</a> or the headless mode of your browser.</p>
<h3 class="anchor anchorWithStickyNavbar_ft1v" id="headless">Headless<a href="#headless" class="hash-link" aria-label="Direct link to Headless" title="Direct link to Headless">​</a></h3>
<p>Many browsers now have the ability to natively run in headless mode. For example, passing these modified <code>WdOptions</code> to <code>introduceWebDriver</code> will run using headless Firefox.</p>
<div class="language-haskell codeBlockContainer_U6bZ theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_I3XA"><pre tabindex="0" class="prism-code language-haskell codeBlock_jAeK thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_XajP"><span class="token-line" style="color:#bfc7d5"><span class="token hvariable">wdOptions</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token hvariable">defaultWdOptions</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token hvariable">capabilities</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token hvariable">firefoxCapabilities</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">Nothing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token hvariable">runMode</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">RunHeadless</span><span class="token plain"> </span><span class="token hvariable">defaultHeadlessConfig</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup_fUqw"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_xOtH" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_SKyo"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_vKap"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Alternatively, if you use Sandwich&#x27;s <a href="http://hackage.haskell.org/package/sandwich/docs/Test-Sandwich.html#v:runSandwichWithCommandLineArgs" target="_blank" rel="noopener noreferrer">runSandwichWithCommandLineArgs</a> in conjunction with <a href="http://hackage.haskell.org/package/sandwich-webdriver/docs/Test-Sandwich-WebDriver.html#v:introduceWebDriverOptions" target="_blank" rel="noopener noreferrer">introduceWebDriverOptions</a>, you can enable headless mode by passing <code>--headless</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_ft1v" id="xvfb">Xvfb<a href="#xvfb" class="hash-link" aria-label="Direct link to Xvfb" title="Direct link to Xvfb">​</a></h3>
<p>Xvfb can be used to run your browser on a separate, &quot;virtual&quot; X11 display, different from the one connected to your monitor. This was more useful before headless browser modes existed, but it&#x27;s still important because it gives you the ability to record <strong>video</strong>. When a Selenium test is running on an Xvfb display, you can use <a href="https://ffmpeg.org/" target="_blank" rel="noopener noreferrer">ffmpeg</a> to record videos of the test runs for later examination.</p>
<p>Xvfb mode can be configured manually just like headless mode.</p>
<div class="language-haskell codeBlockContainer_U6bZ theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_I3XA"><pre tabindex="0" class="prism-code language-haskell codeBlock_jAeK thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_XajP"><span class="token-line" style="color:#bfc7d5"><span class="token hvariable">wdOptions</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token hvariable">defaultWdOptions</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token hvariable">capabilities</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token hvariable">chromeCapabilities</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token hvariable">runMode</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">RunInXvfb</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">XvfbConfig</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup_fUqw"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_xOtH" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_SKyo"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_vKap"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Or, if you use Sandwich&#x27;s <a href="http://hackage.haskell.org/package/sandwich/docs/Test-Sandwich.html#v:runSandwichWithCommandLineArgs" target="_blank" rel="noopener noreferrer">runSandwichWithCommandLineArgs</a> in conjunction with <a href="http://hackage.haskell.org/package/sandwich-webdriver/docs/Test-Sandwich-WebDriver.html#v:introduceWebDriverOptions" target="_blank" rel="noopener noreferrer">introduceWebDriverOptions</a>, you can enable Xvfb mode by passing <code>--xvfb</code>.</p>
<div class="theme-admonition theme-admonition-note admonition_AO6I alert alert--secondary"><div class="admonitionHeading_NPmX"><span class="admonitionIcon_es1S"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_k3LA"><p>Xvfb and ffmpeg must be installed in the test environment to use these features.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_ft1v" id="recording-videos">Recording videos<a href="#recording-videos" class="hash-link" aria-label="Direct link to Recording videos" title="Direct link to Recording videos">​</a></h2>
<p>As discussed above, recording video doesn&#x27;t work in headless (<code>--headless</code>) mode. It requires normal (<code>--current</code>) or Xvfb (<code>--xvfb</code>) mode.</p>
<h3 class="anchor anchorWithStickyNavbar_ft1v" id="manually">Manually<a href="#manually" class="hash-link" aria-label="Direct link to Manually" title="Direct link to Manually">​</a></h3>
<p>Using the methods in <a href="http://hackage.haskell.org/package/sandwich-webdriver/docs/Test-Sandwich-WebDriver-Video.html" target="_blank" rel="noopener noreferrer">Test.Sandwich.WebDriver.Video</a>, you can wrap arbitrary sections of a test in video recording. The example below can be found in the <code>webdriver-video</code> demo.</p>
<div class="language-haskell codeBlockContainer_U6bZ theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_I3XA"><pre tabindex="0" class="prism-code language-haskell codeBlock_jAeK thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_XajP"><span class="token-line" style="color:#bfc7d5"><span class="token hvariable">manualVideo</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">TopSpec</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token hvariable">manualVideo</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token hvariable">introduceWebDriver</span><span class="token plain"> </span><span class="token hvariable">defaultWdOptions</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">$</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token hvariable">describe</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;video recording&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">$</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token hvariable">it</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;opens Google&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">$</span><span class="token plain"> </span><span class="token hvariable">withSession1</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">$</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token hvariable">openPage</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;http://www.google.com&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token constant" style="color:rgb(130, 170, 255)">Just</span><span class="token plain"> </span><span class="token hvariable">dir</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;-</span><span class="token plain"> </span><span class="token hvariable">getCurrentFolder</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">let</span><span class="token plain"> </span><span class="token hvariable">path</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token hvariable">dir</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;/&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;video&quot;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">-- No extension needed</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token hvariable">bracket</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token hvariable">startBrowserVideoRecording</span><span class="token plain"> </span><span class="token hvariable">path</span><span class="token plain"> </span><span class="token hvariable">defaultVideoSettings</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token hvariable">endVideoRecording</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">$</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">\</span><span class="token hvariable">_</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token hvariable">search</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;-</span><span class="token plain"> </span><span class="token hvariable">findElem</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token constant" style="color:rgb(130, 170, 255)">ByCSS</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token hvariable">i</span><span class="token operator" style="color:rgb(137, 221, 255)">|*</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token hvariable">title</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Search&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token hvariable">click</span><span class="token plain"> </span><span class="token hvariable">search</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token hvariable">sendKeys</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Haskell Sandwich&quot;</span><span class="token plain"> </span><span class="token hvariable">search</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token hvariable">findElem</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token constant" style="color:rgb(130, 170, 255)">ByCSS</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token hvariable">i</span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token hvariable">input</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token keyword" style="font-style:italic">type</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;submit&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;&gt;=</span><span class="token plain"> </span><span class="token hvariable">click</span><br></span></code></pre><div class="buttonGroup_fUqw"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_xOtH" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_SKyo"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_vKap"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You can also wrap video around multiple tests by using the <a href="http://hackage.haskell.org/package/sandwich/docs/Test-Sandwich.html#v:around" target="_blank" rel="noopener noreferrer">around</a> node, or around individual tests using <a href="http://hackage.haskell.org/package/sandwich/docs/Test-Sandwich.html#v:aroundEach" target="_blank" rel="noopener noreferrer">aroundEach</a>, etc.</p>
<h3 class="anchor anchorWithStickyNavbar_ft1v" id="with-command-line-options">With command line options<a href="#with-command-line-options" class="hash-link" aria-label="Direct link to With command line options" title="Direct link to With command line options">​</a></h3>
<p>If you use Sandwich&#x27;s <a href="http://hackage.haskell.org/package/sandwich/docs/Test-Sandwich.html#v:runSandwichWithCommandLineArgs" target="_blank" rel="noopener noreferrer">runSandwichWithCommandLineArgs</a> in conjunction with <a href="http://hackage.haskell.org/package/sandwich-webdriver/docs/Test-Sandwich-WebDriver.html#v:introduceWebDriverOptions" target="_blank" rel="noopener noreferrer">introduceWebDriverOptions</a>, then you can take advantage of the built-in command line arguments <code>--individual-videos</code> and <code>--error-videos</code>. The former will record videos of every individual test and store them in the corresponding folder on disk. The latter will do the same, but will delete the videos if the test ran successfully, so you only end up with error videos.</p>
<p>You can try this out by running:</p>
<div class="language-bash codeBlockContainer_U6bZ theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_I3XA"><pre tabindex="0" class="prism-code language-bash codeBlock_jAeK thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_XajP"><span class="token-line" style="color:#bfc7d5"><span class="token plain">stack run demo-webdriver -- --individual-videos</span><br></span></code></pre><div class="buttonGroup_fUqw"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_xOtH" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_SKyo"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_vKap"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_ft1v" id="screenshots">Screenshots<a href="#screenshots" class="hash-link" aria-label="Direct link to Screenshots" title="Direct link to Screenshots">​</a></h2>
<p>Because every Sandwich test tree has an associated directory in the filesystem, it&#x27;s easy to capture screenshots during a test.</p>
<div class="language-haskell codeBlockContainer_U6bZ theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_I3XA"><pre tabindex="0" class="prism-code language-haskell codeBlock_jAeK thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_XajP"><span class="token-line" style="color:#bfc7d5"><span class="token constant" style="color:rgb(130, 170, 255)">Just</span><span class="token plain"> </span><span class="token hvariable">dir</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;-</span><span class="token plain"> </span><span class="token hvariable">getCurrentFolder</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token hvariable">screenshot</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;&gt;=</span><span class="token plain"> </span><span class="token hvariable">liftIO</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">.</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">BL</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token builtin" style="color:rgb(130, 170, 255)">writeFile</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token hvariable">dir</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;/&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;screenshot.png&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup_fUqw"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_xOtH" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_SKyo"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_vKap"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_ft1v" id="custom-selenium-and-driver-binaries">Custom Selenium and driver binaries<a href="#custom-selenium-and-driver-binaries" class="hash-link" aria-label="Direct link to Custom Selenium and driver binaries" title="Direct link to Custom Selenium and driver binaries">​</a></h2>
<p>By default, the WebDriver machinery will obtain the Selenium JAR and driver binaries from the web automatically. However, you can also manually configure which ones are used by passing a disk path.</p>
<div class="language-haskell codeBlockContainer_U6bZ theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_I3XA"><pre tabindex="0" class="prism-code language-haskell codeBlock_jAeK thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_XajP"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">data</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">WdOptions</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">WdOptions</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token operator" style="color:rgb(137, 221, 255)">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token hvariable">seleniumToUse</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">UseSeleniumAt</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/path/to/selenium.jar&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token hvariable">chromeDriverToUse</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">UseChromeDriverAt</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/path/to/chromedriver&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token hvariable">geckoDriverToUse</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">UseGeckoDriverAt</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/path/to/geckodriver&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup_fUqw"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_xOtH" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_SKyo"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_vKap"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Alternatively, you can pass <a href="http://hackage.haskell.org/package/sandwich-webdriver/docs/Test-Sandwich-WebDriver-Config.html#t:SeleniumToUse" target="_blank" rel="noopener noreferrer">DownloadSeleniumFrom</a> with a URL to download, and similarly for the other options. Please see the Haddocks for more details.</p>
<h2 class="anchor anchorWithStickyNavbar_ft1v" id="running-tests-in-parallel-with-a-webdriver-pool">Running tests in parallel with a webdriver pool<a href="#running-tests-in-parallel-with-a-webdriver-pool" class="hash-link" aria-label="Direct link to Running tests in parallel with a webdriver pool" title="Direct link to Running tests in parallel with a webdriver pool">​</a></h2>
<p>If you have a lot of test files, you probably want to run them in parallel so the test suite finishes faster. However, you probably don&#x27;t want to run them <strong>all</strong> in parallel, since running that many browser sessions could bog down your CI machine. A good solution is to use <a href="https://hackage.haskell.org/package/resource-pool" target="_blank" rel="noopener noreferrer">Data.Pool</a> to introduce a fixed-size pool of reusable WebDriver contexts.</p>
<p>You can follow along with this example in the <code>webdriver-pool</code> demo.</p>
<p>The first thing we need to do is come up with a label and introduce a pool of the desired size.</p>
<div class="language-haskell codeBlockContainer_U6bZ theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_I3XA"><pre tabindex="0" class="prism-code language-haskell codeBlock_jAeK thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_XajP"><span class="token-line" style="color:#bfc7d5"><span class="token hvariable">webDriverPool</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">Label</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">Label</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;webDriverPool&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token constant" style="color:rgb(130, 170, 255)">Pool</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">WebDriver</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">type</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">HasWebDriverPool</span><span class="token plain"> </span><span class="token hvariable">context</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">HasLabel</span><span class="token plain"> </span><span class="token hvariable">context</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;webDriverPool&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token constant" style="color:rgb(130, 170, 255)">Pool</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">WebDriver</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token hvariable">introduceWebDriverPool</span><span class="token plain"> </span><span class="token hvariable">poolSize</span><span class="token plain"> </span><span class="token hvariable">wdOptions&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token hvariable">introduce</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Introduce webdriver pool&quot;</span><span class="token plain"> </span><span class="token hvariable">webDriverPool</span><span class="token plain"> </span><span class="token hvariable">alloc</span><span class="token plain"> </span><span class="token hvariable">cleanup</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">where</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token hvariable">alloc</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token hvariable">wdOptions</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;-</span><span class="token plain"> </span><span class="token hvariable">addCommandLineOptionsToWdOptions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                   </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;$&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token hvariable">getCommandLineOptions</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">@</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                   </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;*&gt;</span><span class="token plain"> </span><span class="token hvariable">pure</span><span class="token plain"> </span><span class="token hvariable">wdOptions&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token hvariable">wdOptions</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;-</span><span class="token plain"> </span><span class="token hvariable">addCommandLineOptionsToWdOptions</span><span class="token plain"> </span><span class="token hvariable">clo</span><span class="token plain"> </span><span class="token hvariable">wdOptions&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token hvariable">runRoot</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;-</span><span class="token plain"> </span><span class="token hvariable">fromMaybe</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/tmp&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;$&gt;</span><span class="token plain"> </span><span class="token hvariable">getRunRoot</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token hvariable">liftIO</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">$</span><span class="token plain"> </span><span class="token hvariable">createPool</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token hvariable">allocateWebDriver&#x27;</span><span class="token plain"> </span><span class="token hvariable">runRoot</span><span class="token plain"> </span><span class="token hvariable">wdOptions</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token hvariable">cleanupWebDriver&#x27;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">30</span><span class="token plain"> </span><span class="token hvariable">poolSize</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token hvariable">cleanup</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token hvariable">liftIO</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">.</span><span class="token plain"> </span><span class="token hvariable">destroyAllResources</span><br></span></code></pre><div class="buttonGroup_fUqw"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_xOtH" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_SKyo"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_vKap"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>There&#x27;s some plumbing here because we want to pipe the command line options through. The important part is at the end, where we make a pool that knows how to allocate and deallocate WebDrivers using the lower-level <code>allocateWebDriver&#x27;</code> and <code>cleanupWebDriver&#x27;</code> functions.</p>
<p>Next, we make another introduce node to <em>claim</em> a WebDriver from the pool.</p>
<div class="language-haskell codeBlockContainer_U6bZ theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_I3XA"><pre tabindex="0" class="prism-code language-haskell codeBlock_jAeK thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_XajP"><span class="token-line" style="color:#bfc7d5"><span class="token hvariable">claimWebdriver</span><span class="token plain"> </span><span class="token hvariable">spec</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token hvariable">introduceWith&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token hvariable">defaultNodeOptions</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token hvariable">nodeOptionsRecordTime</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token constant" style="color:rgb(130, 170, 255)">False</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token hvariable">nodeOptionsCreateFolder</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token constant" style="color:rgb(130, 170, 255)">False</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Claim webdriver&quot;</span><span class="token plain"> </span><span class="token hvariable">webdriver</span><span class="token plain"> </span><span class="token hvariable">wrappedAction</span><span class="token plain"> </span><span class="token hvariable">spec</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">where</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token hvariable">wrappedAction</span><span class="token plain"> </span><span class="token hvariable">action</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token hvariable">pool</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;-</span><span class="token plain"> </span><span class="token hvariable">getContext</span><span class="token plain"> </span><span class="token hvariable">webDriverPool</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token hvariable">withResource</span><span class="token plain"> </span><span class="token hvariable">pool</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">$</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">\</span><span class="token hvariable">sess</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token hvariable">void</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">$</span><span class="token plain"> </span><span class="token hvariable">action</span><span class="token plain"> </span><span class="token hvariable">sess</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">`finally`</span><span class="token plain"> </span><span class="token hvariable">closeAllSessions</span><span class="token plain"> </span><span class="token hvariable">sess</span><br></span></code></pre><div class="buttonGroup_fUqw"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_xOtH" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_SKyo"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_vKap"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>There&#x27;s also some plumbing here where we tweak the node options of this to play better with <a href="/sandwich/docs/timing">test timing</a>. This code obtains the pool context, then claims a WebDriver to pass to its sub-nodes. It also cleans up at the end by calling <code>closeAllSessions</code>.</p>
<p>Having written these functions, we can finally write our tests. The following will run all the tests, up to four at a time, re-using the WebDrivers among them.</p>
<div class="language-haskell codeBlockContainer_U6bZ theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_I3XA"><pre tabindex="0" class="prism-code language-haskell codeBlock_jAeK thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_XajP"><span class="token-line" style="color:#bfc7d5"><span class="token hvariable">tests</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">TopSpecWithOptions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token hvariable">tests</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token hvariable">introduceWebDriverPool</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token plain"> </span><span class="token hvariable">defaultWdOptions</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">$</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token hvariable">parallel</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">$</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token hvariable">replicateM_</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">20</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">$</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token hvariable">claimWebdriver</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">$</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token hvariable">it</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;opens Google&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">$</span><span class="token plain"> </span><span class="token hvariable">withSession1</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">$</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token hvariable">openPage</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;http://www.google.com&quot;</span><br></span></code></pre><div class="buttonGroup_fUqw"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_xOtH" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_SKyo"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_vKap"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Of course, in real use you probably want to introduce different tests to run in parallel. You can use <a href="/sandwich/docs/discovery">Test Discovery</a> to automatically generate them.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/master/website/docs/extensions/sandwich-webdriver.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_gEVS" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_X6Ll"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/sandwich/docs/extensions/sandwich-quickcheck"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">QuickCheck</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/sandwich/docs/context-libraries/sandwich-contexts"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Base contexts</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_nnsz thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#browser-sessions" class="table-of-contents__link toc-highlight">Browser sessions</a></li><li><a href="#window-positioning" class="table-of-contents__link toc-highlight">Window positioning</a></li><li><a href="#launching-browsers-in-the-background" class="table-of-contents__link toc-highlight">Launching browsers in the background</a><ul><li><a href="#headless" class="table-of-contents__link toc-highlight">Headless</a></li><li><a href="#xvfb" class="table-of-contents__link toc-highlight">Xvfb</a></li></ul></li><li><a href="#recording-videos" class="table-of-contents__link toc-highlight">Recording videos</a><ul><li><a href="#manually" class="table-of-contents__link toc-highlight">Manually</a></li><li><a href="#with-command-line-options" class="table-of-contents__link toc-highlight">With command line options</a></li></ul></li><li><a href="#screenshots" class="table-of-contents__link toc-highlight">Screenshots</a></li><li><a href="#custom-selenium-and-driver-binaries" class="table-of-contents__link toc-highlight">Custom Selenium and driver binaries</a></li><li><a href="#running-tests-in-parallel-with-a-webdriver-pool" class="table-of-contents__link toc-highlight">Running tests in parallel with a webdriver pool</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/sandwich/docs/">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/sandwich/docs/formatters/slack">Slack integration</a></li><li class="footer__item"><a class="footer__link-item" href="/sandwich/docs/extensions/sandwich-webdriver">Selenium integration</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/codedownio/sandwich/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_qMpq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/sandwich/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/codedownio/sandwich" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_qMpq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Tom McLaughlin. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>